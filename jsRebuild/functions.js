function addToCart(){var t={pid:$(this).closest(".productContent").attr("id"),qty:$(this).siblings(".productsQty").val()};$.ajax({type:"POST",url:"/addItemToBasket",data:t}).done(function(t){updateCart(JSON.parse(t))}).fail(function(){alert("Fail to get Basket")})}function deleteFromCart(){var t={pid:$(this).closest(".productItemInBasket").attr("id")};$.ajax({type:"DELETE",url:"/deleteItemFromBasket",data:t}).done(function(t){updateCart(JSON.parse(t))}).fail(function(){alert("Fail to delete from Basket")})}function loadBasket(){$.ajax({type:"GET",url:"/loadBasket"}).done(function(t){$.ajax({type:"POST",url:"/setBasket"}).done(function(t){$("#basket").append("<div id='basketHeader'><span>"+t.basket_id+"</span></div>"),$("#basket").append("<div id='basketItems'></div>"),$("#basket").append("<div id='basketTotal'>"+t.order_total+"</div>")}).fail(function(){alert("Fail to set Basket")})}).fail(function(){alert("Fail to load Basket")})}function updateCart(t){if($("#basketItems").html(""),t.product_items)for(var e=0;e<t.product_items.length;e++)$("#basketItems").append("<div class='productItemInBasket' id='"+t.product_items[e].item_id+"'><span>Product Name: "+t.product_items[e].product_name+"</span><br/><span>Product Price: "+t.product_items[e].price+"</span><br/><button class='deleteItemFromBasket'>Delete</button><div>");$(".deleteItemFromBasket").off("click").on("click",deleteFromCart),$("#basketTotal").html(t.order_total),t.order_total>0?renderPayPalBtn(t):$("#paypal-button-container").remove()}function renderPayPalBtn(t){$("#paypal-button-container").remove(),$("#basket").append("<div id='paypal-button-container'></div>"),paypal.Button.render({env:"sandbox",client:{sandbox:"ASEShkolv8BsV0ONvzkvd1krpnf_83RFgxsdeCcF-uZYGvipVqPEd6sYZBqXzoD5Y2qbekaCY14i-jAL",production:"XXX"},payment:function(){var e=this.props.env,a=this.props.client;return paypal.rest.payment.create(e,a,{transactions:[{amount:{total:t.order_total,currency:t.currency},item_list:{shipping_address:{recipient_name:t.shipments[0].shipping_address.full_name,line1:t.shipments[0].shipping_address.address1,line2:t.shipments[0].shipping_address.address2,city:t.shipments[0].shipping_address.city,country_code:t.shipments[0].shipping_address.country_code,postal_code:t.shipments[0].shipping_address.postal_code,phone:t.shipments[0].shipping_address.phone,state:t.shipments[0].shipping_address.state_code}}}]})},onAuthorize:function(e,a){return a.payment.execute().then(function(){e={amount:t.order_total},$.ajax({type:"POST",url:"/placeOrder",data:e}).done(function(t){var e=JSON.parse(t);console.log(e),$("#basket").html(""),alert("Thank you for purchase! Please come back, we always waiting for you!")}).fail(function(){alert("Fail to get Product")})})}},"#paypal-button-container")}!function(){loadBasket()}(),$("#getProduct").on("click",function(t){var e={query:$("#query").val()};$.ajax({type:"GET",url:"/getProduct",data:e}).done(function(t){for(var e=0;e<t.length;e++)$("#productInfo").append("<div class='productContent' id='"+t[e].id+"'></div>"),$(".productContent:last").append("<span>Product Name: "+t[e].name+"</span><br/>"),$(".productContent:last").append("<span>Product Color: "+t[e].color+"</span><br/>"),$(".productContent:last").append("<span>Product Size: "+t[e].size+"</span><br/>"),$(".productContent:last").append("<span>Product Price: "+t[e].price+"</span><br/>"),$(".productContent:last").append("<span>Product Count: "+t[e].count+"</span><br/>"),$(".productContent:last").append("<img src='"+t[e].imgLink+"'/><br/>"),$(".productContent:last").append("qty: <input class='productsQty' type='number' min='1' max='"+t[e].count+"' value='1'/>"),$(".productContent:last").append(" <button class='addToCart'>Add to Cart</button>"),$(".addToCart:last").off("click").on("click",addToCart)}).fail(function(){alert("Fail to get Product")})});